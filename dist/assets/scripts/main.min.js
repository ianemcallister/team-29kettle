"use strict";var ckc=angular.module("ckc",["ngRoute","ngSanitize","firebase","720kb.datepicker","angularMoment"]);ckc.run(["$rootScope",function(n){n.$on("$routeChangeSuccess",function(e,t,c){n.title=t.$$route.title})}]);
function acctSettingsController(e){var t=this;t.routeParams=e,t.user=firebase.auth().currentUser,t.saveChanges=function(){const e=firebase.auth().currentUser;e.updateProfile({displayName:t.user.displayName}).then(()=>{console.log("updated successfully")}).catch(e=>{console.log("update error",e)})},console.log("in the account settings  controller ")}ckc.controller("acctSettingsController",acctSettingsController),acctSettingsController.$inject=["$routeParams"];
function activitiesController(e){var o=this;o.newDateObject=new Date,o.date="",console.log(o.newDateObject),o.dateUpdate=function(){var e=Date.parse(o.newDateObject),t=new Date(e).toISOString();new Date(o.newDateObject);console.log("Parsed Date:",e),console.log("clean date: ",t)},console.log("in the activities controller ")}ckc.controller("activitiesController",activitiesController),activitiesController.$inject=["$scope"];
function channelController(){console.log("$routeParams",$routeParams);$log.info("in the chanels controller ",$scope)}ckc.controller("channelController",channelController),channelController.$inject=[];
function dashboardController(r,o,e){console.log("$routeParams",r);var a=this;a.user=firebase.auth().currentUser,a.routeParams=r,a.today=function(){return e().format()},console.log("in the dash controller")}ckc.controller("dashboardController",dashboardController),dashboardController.$inject=["$routeParams","$firebaseObject","moment"];
function documentationController(){var o=this;o.data=data,$log.info("in the documentation controller ",o.data,o.url)}ckc.controller("documentationController",documentationController),documentationController.$inject=[];
function loginController(){var e=new firebaseui.auth.AuthUI(firebase.auth());e.start("#firebaseui-auth-container",{signInOptions:[firebase.auth.EmailAuthProvider.PROVIDER_ID]});var o={callbacks:{signInSuccessWithAuthResult:function(e,o){e=e.user.uid;return window.location.assign("/#/member/"+e),!1},uiShown:function(){document.getElementById("loader").style.display="none"}},signInFlow:"popup",signInSuccessUrl:"/#/member/290ug",signInOptions:[firebase.auth.EmailAuthProvider.PROVIDER_ID,firebase.auth.PhoneAuthProvider.PROVIDER_ID,firebase.auth.GoogleAuthProvider.PROVIDER_ID,firebase.auth.FacebookAuthProvider.PROVIDER_ID],tosUrl:"<your-tos-url>",privacyPolicyUrl:"<your-privacy-policy-url>"};e.start("#firebaseui-auth-container",o),console.log("in the login controller")}ckc.controller("loginController",loginController),loginController.$inject=[];
function txsAssigmentsController(a,t,r){var n=this;n.user=firebase.auth().currentUser,n.currentDate=new Date,n.allTeamMembers=a(firebase.database().ref("Members")),n.dailyFundsCollected=a(firebase.database().ref("FundsCollected").orderByChild("refDate").equalTo(r(n.currentDate).format("YYYY-MM-DD"))),n.dailyEngagments=a(firebase.database().ref("Engagments").orderByChild("date").equalTo(r(n.currentDate).format("YYYY-MM-DD"))),n.searchDate=function(e){let t=r();null!=e&&(t=r(new Date(e)),console.log(e,"searching date",t.format()),n.dailyFundsCollected=a(firebase.database().ref("FundsCollected").orderByChild("refDate").equalTo(t.format("YYYY-MM-DD"))),n.dailyEngagments=a(firebase.database().ref("Engagments").orderByChild("date").equalTo(t.format("YYYY-MM-DD"))))},n.openEngament=function(e){t.path("/admin/engagments/"+e)},console.log("in the txsAssigmentsController  controller ")}ckc.controller("txsAssigmentsController",txsAssigmentsController),txsAssigmentsController.$inject=["$firebaseObject","$location","moment"];
function activity(){i.$inject=["scope","el","attr","ctrl"];var t={restrict:"AECM",templateUrl:"assets/views/directives/activity.htm",replace:!0,scope:{},link:i,controller:e,controllerAs:"vm",bindToController:!0};function i(t,i,e,c){}function e(i,e){this.buttons=function(t){console.log("Clicked ",t),"selectActivity"===t&&e.path("/member/"+i.uid+"/activities")},console.log("in the activity directive")}return e.$inject=["State","$location"],t}ckc.directive("activity",activity);
function cookingRecorder(){o.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/minishop/directives/cookingRecorder.htm",replace:!0,scope:{},link:o,controller:t,controllerAs:"vm",bindToController:!0};function o(e,o,t,r){}function t(){console.log("in the Cooking Recorder Directive");this.options={"1s09ugasoigas":{title:"",recipe:"Sweet & Salty",nut:"Pecans",style:{"background-color":"#0000ff"}},"paosjg;oiahwe":{title:"",recipe:"Sweet & Salty",nut:"Almonds",style:{"background-color":"#0000ff"}},pejsg09u2nssd:{title:"",recipe:"Sweet & Salty",nut:"Cashews",style:{"background-color":"#0000ff"}},"029ugojsdohbs":{title:"",recipe:"Sweet & Salty",nut:"Hazelnuts",style:{"background-color":"#0000ff"}},Moshdwebosi13:{title:"",recipe:"Bourbon",nut:"Pecans",style:{"background-color":"#0000ff"}},"923NGashigbsd":{title:"",recipe:"Bourbon",nut:"Almonds",style:{"background-color":"#0000ff"}},"jweoi2#9ssdgw":{title:"",recipe:"Bourbon",nut:"Cashews",style:{"background-color":"#0000ff"}},"2ANSgih3sh2#-":{title:"",recipe:"Bourbon",nut:"Hazelnuts",style:{"background-color":"#0000ff"}}},this.swiped=function(e){console.log(e,"swiped")}}return t.$inject=[],e}ckc.directive("cookingRecorder",cookingRecorder);
function dailyAllocationsByEvent(){e.$inject=["scope","el","attr","ctrl"];var t={restrict:"AECM",templateUrl:"assets/views/directives/daily-allocations-by-event.htm",replace:!0,scope:{date:"=",updates:"&"},link:e,controller:n,controllerAs:"vm",bindToController:!0};function e(n,t,e,l){n.$watch("date",function(t,e){n.vm.loadEngagments(n.vm.date)})}function n(t,e){console.log("in the daily allocations by event directive"),t.vm.loadEngagments=function(){console.log("loading engagments")}}return n.$inject=["$scope","$log"],t}ckc.directive("dailyAllocationsByEvent",dailyAllocationsByEvent);
function dailyFundsCollected(){t.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/daily-funds-collected.htm",replace:!0,scope:{date:"="},link:t,controller:l,controllerAs:"vm",bindToController:!0};function t(l,e,t,o){l.$watch("date",function(e,t){l.vm.loadPayments(l.vm.date)})}function l(t,e,l,o){console.log("in the daily funds collected directive");var n,a=this;a.paymentsCollected="",a.teamMemberProfiles=(n=firebase.database().ref("Members"),o(n)),t.vm.concatenateName=function(e){var t="UNKNOWN";return t=null!=a.teamMemberProfiles[e]?a.teamMemberProfiles[e].firstName+" "+a.teamMemberProfiles[e].lastName:t},t.vm.loadPayments=function(e){l.get.dailyCollections(e).then(function(e){var l,o;console.log(e),t.vm.paymentsCollected=e,t.vm.collectionsByTeamMember=(l=e,o={},Object.keys(l).forEach(function(e){var t=l[e].employeeId;null==t?(null==o.UNKNOWN&&(o.UNKNOWN={totalCollections:0,totalFundsCollected:0,totalSalesCollected:0,firstCollection:"",lastCollection:"",txs:{}}),o.UNKNOWN.txs[e]=l[e],o.UNKNOWN.totalCollections++,o.UNKNOWN.totalFundsCollected+=l[e].totalMoney.amount,o.UNKNOWN.totalSalesCollected+=l[e].amountMoney.amount,null!=l[e].tipMoney&&(o.UNKNOWN.totalTipsCollected+=l[e].tipMoney.amount)):(null==o[t]&&(o[t]={totalCollections:0,totalFundsCollected:0,totalSalesCollected:0,totalTipsCollected:0,firstCollection:"",lastCollection:"",txs:{}}),o[t].txs[e]=l[e],o[t].totalCollections++,o[t].totalFundsCollected+=l[e].totalMoney.amount,o[t].totalSalesCollected+=l[e].amountMoney.amount,null!=l[e].tipMoney&&(o[t].totalTipsCollected+=l[e].tipMoney.amount))}),o)}).catch(function(e){console.log("error: ",e)})}}return l.$inject=["$scope","$log","Database","$firebaseObject"],e}ckc.directive("dailyFundsCollected",dailyFundsCollected);
function ckcFooter(){o.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/footer.htm",replace:!0,scope:{},link:o,controller:t,controllerAs:"vm",bindToController:!0};function o(e,o,t,c){}function t(e,o){console.log("in the footer directive")}return t.$inject=["$scope","$log"],e}ckc.directive("ckcFooter",ckcFooter);
function ckcNavbar(){o.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/navbar.htm",replace:!0,scope:{},link:o,controller:c,controllerAs:"vm",bindToController:!0};function o(e,o,c,t){}function c(e,o,c,t){var n=this;n.user=null,t.$onAuthStateChanged(e=>{console.log("user: ",e),n.user=e}),n.menuClick=function(e){switch(e){case"Menu":console.log("Menu clicked"),c.path("/member/"+n.user.uid);break;case"Reports":console.log("Reports Clicked");break;case"Settings":console.log("settings clicked"),c.path("/member/"+n.user.uid+"/settings");break;case"Login":console.log("logging in"),c.path("/login");break;case"LogOut":console.log("logging out"),t.$signOut(),c.path("/login")}}}return c.$inject=["$scope","$log","$location","Auth"],e}ckc.directive("ckcNavbar",ckcNavbar);
function powerSource(){r.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/minishop/directives/powerSource.htm",replace:!0,scope:{},link:r,controller:o,controllerAs:"vm",bindToController:!0};function r(e,r,o,c){}function o(){console.log("in the Power Source Directive")}return o.$inject=[],e}ckc.directive("powerSource",powerSource);
function config(e,t){t.hashPrefix(""),e.when("/",{redirectTo:"/member"}).when("/login",{templateUrl:"assets/views/login-page.htm",controller:"loginController",controllerAs:"vm"}).when("/member",{templateUrl:"assets/views/dashboard-page.htm",controller:"dashboardController",controllerAs:"vm",resolve:{user:["State","$q","$location",function(e,t,n){var l=t.defer();return e.user().then(function(e){e?n.path("/member/"+e.uid):n.path("/login"),l.resolve()}),l.promise}]}}).when("/member/:uid",{title:"Dashboard",templateUrl:"assets/views/dashboard-page.htm",controller:"dashboardController",controllerAs:"vm",resolve:{user:["State","$q","$location",function(e,t,n){var l=t.defer();return e.user().then(function(e){e?n.path("/member/"+e.uid):n.path("/login"),l.resolve()}),l.promise}]}}).when("/member/:uid/settings",{templateUrl:"assets/views/acct-settings-page.htm",controller:"acctSettingsController",controllerAs:"vm",resolve:{user:["State","$q","$location",function(e,t,n){var l=t.defer();return e.user().then(function(e){e?n.path("/member/"+e.uid+"/settings"):n.path("/login"),l.resolve()}),l.promise}]}}).when("/member/:uid/activities",{templateUrl:"assets/views/activities-page.htm",controller:"activitiesController",controllerAs:"vm",resolve:{user:["State","$q","$location",function(e,t,n){var l=t.defer();return e.user().then(function(e){e?n.path("/member/"+e.uid+"/activities"):n.path("/login"),l.resolve()}),l.promise}]}}).when("/minishop/:engmntId/:channelId/",{title:"Mobile Retail Shop",templateUrl:"assets/views/minishop/mdashboard-page.htm",controller:"minishopDashController",controllerAs:"vm"}).when("/minishop/:engmntId/:channelId/settings",{templateUrl:"assets/views/minishop/settings-page.htm",controller:"minishopStngsController",controllerAs:"vm"}).when("/minishop/:engmntId/:channelId/production",{title:"Minishop: Production",templateUrl:"assets/views/minishop/production-page.htm",controller:"minishopProductionController",controllerAs:"vm"}).when("/minishop/:engmntId/:channelId/salesTxs",{templateUrl:"assets/views/minishop/sales-txs-page.htm",controller:"minishopSalesTxsController",controllerAs:"vm"}).when("/minishop/:engmntId/:channelId/balanceSheet",{templateUrl:"assets/views/minishop/balancesheet-page.htm",controller:"minishopBalancesheetController",controllerAs:"vm"}).when("/minishop/:engmntId/:channelId/power",{templateUrl:"assets/views/minishop/power-source-page.htm",controller:"minishopPowerSourceController",controllerAs:"vm"}).when("/admin/channels",{title:"Admin: Channels",templateUrl:"assets/views/admin/channels-page.htm",controller:"adminChannelsController",controllerAs:"vm"}).when("/admin/channels/:channelId",{title:"Admin: Channels",templateUrl:"assets/views/admin/select-channel-page.htm",controller:"adminSelectChannelController",controllerAs:"vm",resolve:{engagemnts:["Database","$q","$route",function(e,t,n){var l=t.defer();return e.get.channelEngagments(n.current.params.channelId).then(function(e){console.log("got this",e),l.resolve(e)}),l.promise}]}}).when("/admin/engagments/:engagmentId",{title:"Engagment",templateUrl:"assets/views/admin/select-engagment-page.htm",controller:"adminSelectEngagmentController",controllerAs:"vm"}).when("/admin/schedule/weekly",{templateUrl:"assets/views/admin-weekly-schedule-page.htm",controller:"adminWeeklyScheduleController",controllerAs:"vm",resolve:{engagemnts:["Database","$q","$route",function(e,t,n){console.log("routing: ",n.current.params.Wk);var l=t.defer();return e.get.weeklyEngagments(n.current.params.Wk).then(function(e){console.log("got this",e),l.resolve(e)}),l.promise}]}}).when("/admin/fundsAllocations/daily",{templateUrl:"assets/views/admin-funds-allocations-daily-page.htm",controller:"adminFundsAllocationsDailyController",controllerAs:"vm"}).when("/admin/accts",{title:"Admin: Accounts",templateUrl:"assets/views/admin/accts-manage-page.htm",controller:"adminAcctsManageController",controllerAs:"vm"}).when("/admin/BoM",{title:"Admin: Bill Of Materials",templateUrl:"assets/views/admin/bom-list-page.htm",controller:"adminBoMListController",controllerAs:"vm"}).when("/admin/BoM/:bomId",{title:"Admin: Bill Of Materials",templateUrl:"assets/views/admin/a-bom-page.htm",controller:"adminABoMController",controllerAs:"vm"}).when("/admin/operationRoles",{title:"Admin: Roles",templateUrl:"assets/views/admin/opRoles-list-page.htm",controller:"adminOpRolesListContoller",controllerAs:"vm"}).when("/admin/ledgers",{title:"Admin: Ledgers",templateUrl:"assets/views/admin/ledgers-list-page.htm",controller:"adminLedgerslistController",controllerAs:"vm"}).when("/admin/txs_assignments",{templateUrl:"assets/views/txs-assigments-page.htm",controller:"txsAssigmentsController",controllerAs:"vm"}).otherwise({redirectTo:"/"})}config.$inject=["$routeProvider","$locationProvider"],angular.module("ckc").config(config);
function Firebase(){return this.data=["one","two"],console.log("Firebase Service"),{read:function(e){console.log("reading",e);const r=firebase.database().ref(e);return new Promise(function(n,e){r.on("value",function(e){e=e.val();n(e)})})},update:function(e){return new Promise(function(n,r){firebase.database().ref().update(e,function(e){e?(console.log("Firebase Update Error",e),r()):n()})})},query:{child:function(e,n,r){const a=firebase.database().ref(e);a.orderByChild(n).equalTo(r)}}}}ckc.factory("Firebase",Firebase),Firebase.$inject=[];
function Admin(e,r,i){return{get:{docs:function(){var e=firebase.database().ref("Admin/sidebar/doc");return i(e)}}}}ckc.factory("Admin",Admin),Admin.$inject=["$log","$firebaseObject","$firebaseArray"];
function Auth(t){return t()}ckc.factory("Auth",Auth),Auth.$inject=["$firebaseAuth"];
function Channels(e,n,a){return{get:{list:function(){var e=firebase.database().ref("Channels/").orderByChild("name");return n(e)}}}}ckc.factory("Channels",Channels),Channels.$inject=["$log","$firebaseObject","$firebaseArray"];
function Database(o,t){return{get:{channelEngagments:function(e){console.log("GetChannelEngagments: ",e);var n=o.defer();return t({method:"GET",url:"/db/engagments?channelId="+e}).then(function(e){n.resolve(e.data)},function(e){console.log("Error: ",e)}),n.promise},weeklyEngagments:function(e){console.log("GetWeeklyEngagments: ",e);var n=o.defer();return t({method:"GET",url:"/db/engagments?wk="+e}).then(function(e){n.resolve(e.data)},function(e){console.log("Error: ",e)}),n.promise},dailyEngagments:function(e){console.log("GetDailyEngagments: ",e);var n=o.defer();return t({method:"GET",url:"/db/engagments?date="+e}).then(function(e){n.resolve(e.data)},function(e){console.log("Error: ",e)}),n.promise},dailyCollections:function(e){console.log("GetDailyCollections: ",e);var n=o.defer();return t({method:"GET",url:"/db/collections?date="+e}).then(function(e){n.resolve(e.data)},function(e){console.log("Error: ",e)}),n.promise}}}}ckc.factory("Database",Database),Database.$inject=["$q","$http"];
function Documents(e,r,t){return{get:{one:function(e){e="Resources/"+e,e=firebase.database().ref(e);return r(e)},list:function(){var e=firebase.database().ref("Resources/");return r(e)}}}}Documents.$inject=["$log","$firebaseObject","$firebaseArray"],ckc.factory("Documents",Documents),Channels.$inject=["$log","$firebaseObject","$firebaseArray"];
function Engagments(n){this.data=["one","two"],console.log("Engagments Service");return{}}ckc.factory("Engagments",Engagments),Engagments.$inject=["$firebaseObject"];
function Members(e,r,a){return{get:{profile:function(e){e="Members/"+e,e=firebase.database().ref(e);return r(e)},tasks:function(e){var r="Tasks/"+e,e=firebase.database().ref(r).orderByChild("uid").equalTo(e);return a(e)},checklists:function(e){var r="Checklists/"+e,e=firebase.database().ref(r).orderByChild("uid").equalTo(e);return a(e)}}}}ckc.factory("Members",Members),Members.$inject=["$log","$firebaseObject","$firebaseArray"];
function MiniShop(e){console.log("Loading Mini Shop Service");var n=this;return n.engagment={},n.power={},{_engagment:n.engagment,data:{power:n.power},get:"",set:"",update:"",delete:""}}ckc.factory("MiniShop",MiniShop),MiniShop.$inject=["$firebaseObject"];
function msData(e,r,t,n,a,d,i){var o=this;function s(e){e=firebase.database().ref(e);return r(e)}function c(e,t){a.defer();const n=firebase.database();e=n.ref("ProductionReports/"+e);return r(e)}function p(){return d().format("x")}return o.templates={prodReport:{ondeck:{_hold:""},cooking:{_hold:""},cooling:{_hold:""},engagmentId:"",channelName:"",channelId:"",yrWk:0,status:"",journalEntries:{_hold:""},lastStatus:"Off"}},o.data={power:{isOn:s("Engagments/"+t.engmntId+"/power/isOn"),source:s("Engagments/"+t.engmntId+"/power/source"),txs:s("Engagments/"+t.engmntId+"/power/txs")},production:{report:c(t.engmntId,t.channelId)}},o.models={operations:{0:{type:"recipe",recipe:"Sweet & Salty",nut:"Pecans",startAt:"",endAt:"",expiresAt:"",bomid:"-MmdKHDHWZAwg3TZbKmL",roleId:"-MjSoxLGadkQpxtTuhCK"},1:{type:"recipe",recipe:"Sweet & Salty",nut:"Almonds",startAt:"",endAt:"",expiresAt:"",bomid:"-Mnwvwcyoz5iCJDU_3Ce",roleId:"-MnwvGpt6TTehfomFo18"},2:{type:"recipe",recipe:"Sweet & Salty",nut:"Cashews",startAt:"",endAt:"",expiresAt:"",bomid:"-Mnx5dHnnvnx2uh08fmS",roleId:"-MnwvK9M4P5v_9w_2cSa"},3:{type:"recipe",recipe:"Sweet & Salty",nut:"Hazelnuts",startAt:"",endAt:"",expiresAt:"",bomid:"-Mnx747NXrpQtFrHzR2R",roleId:"-MnwvNdZ2xqY2_8u9Ub7"},4:{type:"recipe",recipe:"Bourbon",nut:"Pecans",startAt:"",endAt:"",expiresAt:"",bomid:"-MnvKrSaKkbyRpMRDNRe",roleId:"-MnvHa-65LfIp63akaI-"},5:{type:"recipe",recipe:"Bourbon",nut:"Almonds",startAt:"",endAt:"",expiresAt:"",bomid:"-MnwvyQ-6pGjq1KmyG5I",roleId:"-MnwvSTpy0dJAU5S_vgi"},6:{type:"recipe",recipe:"Bourbon",nut:"Cashews",startAt:"",endAt:"",expiresAt:"",bomid:"-Mnx5eocalohdz-DSEDQ",roleId:"-MnwvTh3Ax5g7KuZL8SB"},7:{type:"recipe",recipe:"Bourbon",nut:"Hazelnuts",startAt:"",endAt:"",expiresAt:"",bomid:"-Mnx74ufhXcxGL-ZLK4J",roleId:"-MnwvXyu20U9VpKhWoJB"},8:{type:"oprtns",proces:"warming",startAt:"",endAt:""},9:{type:"oprtns",proces:"cleaning",startAt:"",endAt:""},10:{type:"oprtns",proces:"off",startAt:""},11:{type:"errors",proces:"burnt",startAt:""}}},{_loadFBObject:s,_loadProdReport:c,_getPowerTxKey:p,data:o.data,models:o.models,templates:o.templates,power:{togglePower:function(){console.log("toggling power"),o.data.power.isOn.$value=!o.data.power.isOn.$value;var e=d().format();o.data.power.txs[p()]={timestamp:e,source:o.data.power.source.$value,turningOn:o.data.power.isOn.$value},o.data.power.isOn.$save(),o.data.power.txs.$save(),n.$broadcast("powerTxsLoaded",o.data.power.txs)}},production:{journalBatchStart:function(r){const n="/BOMs/"+r.cooking.bomid,a={},o={id:firebase.database().ref().child("JournalEntries").push().key,startAt:r.cooking.startAt,endedAt:"",type:"cooking",recipe:r.cooking.recipe,nut:r.cooking.nut,engagmentId:r.engagmentId,channelId:r.channelId,channelName:r.channelName,yrwk:r.yrWk,teamMembrId:r.memberId,teamMemName:"",temperature:r.temp,wind:"",powerSource:"",roaster:r.roasterId,BoMId:r.cooking.bomid,isComplete:!1,txs:{}},s={jeId:"",txIds:[]};return s.jeId=o.id,new Promise(function(e,t){i.read(n).then(function(n){Object.keys(n.resources).forEach(function(e){var t=firebase.database().ref().child("Transactions").push().key,e={journalEntryId:o.id,roleId:e,createdAt:d().format(),updatedAt:"",createdBy:"",updatedBy:"",debit:n.resources[e],credit:0,description:"",engagmentId:r.engagmentId,channelName:r.channelName,channelId:r.channelId};a["/Transactions/"+t]=e,o.txs[t]=t,s.txIds.push(t)}),a["/JournalEntries/"+o.id]=o,console.log("all Updates",a),i.update(a).then(function(){e(s)})})})},journalBatchEnd:function(){}}}}ckc.factory("msData",msData),msData.$inject=["$interval","$firebaseObject","$routeParams","$rootScope","$q","moment","Firebase"];
function Payments(e){var t=this;return t.data=[],{data:t.data,init:function(a){return console.log("payments servce",t.data),["1IX0oFLvDrnVjwvgOw4HxsUzvaB","1OIvavaneeb53GHPQqjgA9o5taB"].forEach(function(a){t.data.push(function(a){console.log("_loadPaymentRecord",a);a="FundsCollected/"+a,a=firebase.database().ref(a);return e(a)}(a))}),console.log(t.data),1}}}ckc.factory("Payments",Payments),Payments.$inject=["$firebaseObject"];
function State(t,e){return t.info("Instanciating State Factory"),{user:function(){return new Promise(function(n,t){e.$onAuthStateChanged(t=>{n(t)})})},uid:null}}ckc.factory("State",State),State.$inject=["$log","Auth"];
function Updates(e,t,a){return{get:{byChannelId:function(e){var a=firebase.firestore();return new Promise(function(t,e){a.collection("Updates").doc("LIqT8yctri3EZILJajKh").get().then(function(e){console.log("dot data"),t(e.data())})})}}}}ckc.factory("Updates",Updates),Updates.$inject=["$log","$firebaseObject","$firebaseArray"];
function adminABoMController(e,o,r){const s=this,c=firebase.database();var n=c.ref("BOMs/"+o.bomId),o=c.ref("OpRoles");s.record=e(n),s.roleOptions=e(o),s.aNewResource={id:"",qty:""},s.aNewSuccess={id:"",qty:""},s.aNewFailure={id:"",qty:""},s.addBtn=function(e,o){console.log("adding a new",e,o),""==s.record[e]&&(s.record[e]={}),s.record[e][o.id]=function(e){let o=0;o=(1<e?parseInt:parseFloat)(e);return o}(o.qty),s.record.$save().then(function(){switch(console.log("new values saved successfully"),e){case"resources":s.aNewResource={id:"",qty:""};break;case"success":s.aNewSuccess={id:"",qty:""};break;case"failure":s.aNewFailure={id:"",qty:""}}})},s.removeButton=function(e,o){console.log("removing",e,o),s.record[e][o]=null,s.record.$save().then(function(){console.log("removal saved successfully")})},console.log("in a bill of materials controller ")}ckc.controller("adminABoMController",adminABoMController),adminABoMController.$inject=["$firebaseObject","$routeParams","$scope"];
function adminAcctsManageController(n){console.log();const c=firebase.database();var e=c.ref("Accts");this.allAccts=n(e),console.log("in the Admin ACcounts Manager controller ")}ckc.controller("adminAcctsManageController",adminAcctsManageController),adminAcctsManageController.$inject=["$firebaseObject"];
function adminBoMListController(e,o){const s=this,r=firebase.database();var i=r.ref("BOMs");r.ref("OpRoles");s.bomsList=e(i),s.newRecord="",s.createNewRecord=function(e){var o=firebase.database().ref().child("BOMs").push().key;s.bomsList[o]={description:"",failure:"",id:o,name:e,prodSeconds:0,resources:"",success:""},s.bomsList.$save().then(function(){console.log("new record saved successfully")})},console.log("in the bill of materials controller ")}ckc.controller("adminBoMListController",adminBoMListController),adminBoMListController.$inject=["$firebaseObject","$scope"];
function adminChannelsController(n,e,a){console.log("$routeParams",n);var o=this;o.channelsData=e(firebase.database().ref("Channels")),o.routeParams=n,o.newRecord={name:"",type:""},o.rowClicked=function(n){a.path("/admin/channels/"+n)},o.addChannel=function(){var n=firebase.database().ref("Channels").push().key;o.channelsData[n]=o.newRecord,o.channelsData.$save().then(function(){console.log("new record saved successfully")}).catch(function(n){console.log("error saving",n)})},console.log("in the admin channels controller ")}ckc.controller("adminChannelsController",adminChannelsController),adminChannelsController.$inject=["$routeParams","$firebaseObject","$location"];
function adminFundsAllocationsDailyController(n,t,o,a){console.log("Payments:",a);var l=this;l.currentDate="",l.engagments="",l.txsList=a.data,l.processUpdates=function(){},l.formatTime=function(n){n=l.currentDate+"T"+n;return o(n).format("h:mm a")},null!=n.date&&(l.currentDate=n.date,a.init(n.date)),Object.keys(n)<1&&(n="admin/fundsAllocations/daily?date="+o().format("YYYY-MM-DD"),console.log(n),t.url(n))}ckc.controller("adminFundsAllocationsDailyController",adminFundsAllocationsDailyController),adminFundsAllocationsDailyController.$inject=["$routeParams","$location","moment","Payments"];
function adminLedgerslistController(e,c){const s=this,t=firebase.database();var a=t.ref("Ledgers"),l=t.ref("Accts"),n=t.ref("SubAccts"),r=t.ref("Channels");s.ledgersList=e(a),s.acctsList=e(l),s.subAcctsList=e(n),s.channelsList=e(r),s.activeSelection={type:"",acct:"",sact:"",chnl:""},s.addLedger=function(e){console.log("adding a new ledger",e);var c=firebase.database().ref().child("Ledgers").push().key;s.ledgersList[c]={acctId:e.acct,acctName:s.acctsList[e.acct].name,channelId:e.chnl,channelName:s.channelsList[e.chnl].name,ledgerId:c,subAcctId:e.sact,subAcctName:s.subAcctsList[e.sact].name,type:e.type},s.ledgersList.$save().then(function(){console.log("list saved sucessfully"),s.activeSelection={type:"",acct:"",sact:"",chnl:""}})},console.log("in the ledger list controller ")}ckc.controller("adminLedgerslistController",adminLedgerslistController),adminLedgerslistController.$inject=["$firebaseObject","$scope"];
function adminOpRolesListContoller(e,o){var s=this;const t=firebase.database();var n=t.ref("OpRoles");function i(e){const o=null!=e?e:"";return o}s.opRolesList=e(n),s.currentRecord={id:"",name:"",UoM:"",description:"",notes:""},s.editRecord=function(e){s.currentRecord={id:e,name:i(s.opRolesList[e].name),UoM:i(s.opRolesList[e].UoM),description:i(s.opRolesList[e].description),notes:i(s.opRolesList[e].notes)}},s.addSelection=function(){var e;""==s.currentRecord.id?(e=firebase.database().ref().child("OpRoles").push().key,s.opRolesList[e]=s.currentRecord):s.opRolesList[s.currentRecord.id]=s.currentRecord,s.opRolesList.$save().then(function(){console.log("saved successfully"),s.currentRecord={id:"",name:"",UoM:"",description:"",notes:""}})},console.log("in the op roles list controller ",s.opRolesList)}ckc.controller("adminOpRolesListContoller",adminOpRolesListContoller),adminOpRolesListContoller.$inject=["$firebaseObject","$scope"];
function adminSelectChannelController(a,n,e,t,s){console.log("$routeParams",a);const o=this;o.channelData=n(firebase.database().ref("Channels/"+a.channelId)),o.allChannels=n(firebase.database().ref("Channels")),o.chnlEngagments=n(firebase.database().ref("Engagments").orderByChild("channelId").equalTo(a.channelId)),o.engagementsData=t,o.newRLSelections={roleid:"",ledgerId:""},o.frequency={0:"Daily",1:"Weekly",2:"Bi-Weekly",3:"Monthly",4:"Yearly",5:"Other"},o.newEngagmentsOptions={type:"",instances:[]},o.saveData=function(){o.channelData.$save().then(function(){console.log("data saved successfully")}).catch(function(n){console.log("Error Saving Data",n)})},o.rowClick=function(n){console.log(n),e.path("/admin/engagments/"+n)},o.sumEngagments=function(n){var e=0;return Object.keys(n).forEach(function(n){e=n.length}),e},o.buildNewEngagments=function(){o.newEngagmentsOptions.instances.push({d:0,m:0,y:0,startsAtHr:0,startsAtMn:0,endsAtHr:0,endsAtMn:0})},o.addNewEngagments=function(){o.newEngagmentsOptions.instances.forEach(function(n){var e=firebase.database().ref("Engagments").push().key;const t=s().local().year(n.y).month(n.m-1).date(n.d).hour(0).minute(0).second(0);o.chnlEngagments[e]={channel:o.channelData.name,channelId:a.channelId,closesAt:t.hour(n.endsAtHr).minute(n.endsAtMn).second(0).format("HH:mm:ss")+t.hour(n.endsAtHr).minute(n.endsAtMn).format("Z"),d:t.format("e"),date:t.format("MM-DD-YYYY"),opensAt:t.hour(n.startsAtHr).minute(n.startsAtMn).second(0).format("HH:mm:ss")+t.hour(n.endsAtHr).minute(n.endsAtMn).format("Z"),wk:t.format("w"),yr:t.format("YY")}}),o.chnlEngagments.$save().then(function(){console.log("new record saved successfully")}).catch(function(n){console.log("error saving",n)})},console.log("in the admin select channel controller ")}ckc.controller("adminSelectChannelController",adminSelectChannelController),adminSelectChannelController.$inject=["$routeParams","$firebaseObject","$location","engagemnts","moment"];
function adminSelectEngagmentController(e,n,t,o){console.log("$routeParams",e);var a=this;a.engagmentData=n(firebase.database().ref("Engagments/"+e.engagmentId)),a.routeParams=e,a.user=firebase.auth().currentUser,a.channelClicked=function(n){console.log(n),t.path("/admin/channels/"+n)},a.dateConcatenate=function(n,e){const t=o();if(null!=n&&null!=e){n=n.split("-");const a=e.split("-");e=a[0].split(":");t.year(n[2]).month(n[0]-1).date(n[1]).hour(e[0]).minute(e[1]).second(e[2])}return t.format()},a.yrWkDConcatenate=function(n,e,t){if(null!=n&&null!=e&&null!=t)return n.toString()+e.toString()+t.toString()},a.launchReporting=function(){var n="/minishop/"+e.engagmentId+"/"+a.engagmentData.channelId;t.path(n)}}ckc.controller("adminSelectEngagmentController",adminSelectEngagmentController),adminSelectEngagmentController.$inject=["$routeParams","$firebaseObject","$location","moment"];
function adminWeeklyScheduleController(a,r,l,e){var n,o,t,d=this;d.currentWeek="",d.currentYear="",d.kitOrChannel="Channel",d.days="",d.engagments="",Object.keys(r)<1&&(n="admin/schedule/weekly?Yr="+l().format("YY")+"&&Wk="+l().week(),console.log(n),a.url(n)),null!=r.Wk&&(d.currentWeek=r.Wk),null!=r.Yr&&(d.currentYear=20+r.Yr.toString()),null!=r.Wk&&null!=r.Yr&&(d.days={0:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(1).format(),1:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(2).format(),2:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(3).format(),3:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(4).format(),4:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(5).format(),5:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(6).format(),6:l().year("20"+r.Yr).week(r.Wk).isoWeekday("Monday").day(7).format()}),null!=e&&(d.engagemnts=(o=e,t={},Object.keys(o).forEach(function(e){var n=o[e].channelId;null==t[n]&&(t[n]={channel:o[e].channel,channelId:o[e].channelId,engagments:[{},{},{},{},{},{},{}]});var a=0,r=l(o[e].date),a=0==r.day()?6:r.day()-1;t[n].engagments[a]=o[e],t[n].engagments[a].engagmentId=e}),console.log("channels list: ",t),t)),d.leftArrow=function(){var e=parseInt(r.Yr),n=parseInt(r.Wk);1==parseInt(r.Wk)?(e--,n=52):n--,a.url("admin/schedule/weekly?Yr="+e+"&&Wk="+n)},d.rightArrow=function(){var e=parseInt(r.Yr),n=parseInt(r.Wk);52==parseInt(r.Wk)?(e++,n=1):n++,a.url("admin/schedule/weekly?Yr="+e+"&&Wk="+n)},console.log("in the adminWeeklyScheduleController  controller ",r)}ckc.controller("adminWeeklyScheduleController",adminWeeklyScheduleController),adminWeeklyScheduleController.$inject=["$location","$routeParams","moment","engagemnts"];
function minishopBalancesheetController(){console.log("in the balance sheet controller ")}ckc.controller("minishopBalancesheetController",minishopBalancesheetController),minishopBalancesheetController.$inject=[];
function minishopDashController(){console.log("in the miniship dash controller ")}ckc.controller("minishopDashController",minishopDashController),minishopDashController.$inject=[];
function minishopPowerSourceController(o,n,e,s,d){let t=this;function c(o,n){n=function(o,n){const e={timeblocks:[],opSeconds:n},s=function(n){const e={};return Object.keys(n).forEach(function(o){"$$conf"!=o&&"$id"!=o&&"$priority"!=o&&"$resolved"!=o&&(e[o]=n[o])}),e}(o),t=[];e.opSeconds.generator.total=0,e.opSeconds.generator.continous=0,e.opSeconds.house.total=0,e.opSeconds.house.continous=0;o=d().format();s[o]={timestamp:o},Object.keys(s).forEach(function(o){t.push(o)});for(let o=0;o<t.length-1;o++){var c=t[o],r=t[o+1],i=d(s[c].timestamp);const a=d(s[r].timestamp),l=d.duration(a.diff(i)),u={prcntg:100*(l.as("seconds")/86399).toFixed(2),seconds:l.as("seconds"),isOn:p(s[c]),classes:["progress-bar"]};u.isOn&&u.classes.push("bg-warning"),p(s[c])&&null!=e.opSeconds&&(e.opSeconds.house.total+=l.as("seconds"),e.opSeconds.house.continous=l.as("seconds")),e.timeblocks.push(u)}return e}(o,n);t.timeblocks=n.timeblocks,t.opSeconds=n.opSeconds}function p(o){let n=!1;return null!=o.turningOn&&o.turningOn&&(n=!0),n}e.Math=window.Math,t.params=n,t.opSeconds={house:{total:0,continous:0},generator:{total:0,continous:0}},t.timeblocks=[],s.data.power.isOn.$bindTo(e,"vm.powerIsOn"),s.data.power.source.$bindTo(e,"vm.powerSource"),s.data.power.txs.$bindTo(e,"vm.txs").then(function(){console.log("bind finished loading"),c(t.txs,t.opSeconds)}),t.toggleOnOff=function(){s.power.togglePower()},e.$on("powerTxsLoaded",function(o,n){console.log("PowerSourceController: txs data loaded"),c(n,t.opSeconds)}),o(function(){c(t.txs,t.opSeconds)},1e4)}ckc.controller("minishopPowerSourceController",minishopPowerSourceController),minishopPowerSourceController.$inject=["$interval","$routeParams","$scope","msData","moment"];
function minishopProductionController(r,o,t,e,n,a,i,s){let p=this;p.params=o;function c(n){Object.keys(p.txsSummary).forEach(function(r){const o=p.txsSummary[r];Object.keys(o).forEach(function(t){const e=o[t];Object.keys(e).forEach(function(o){e[o].id==n.roleId&&(p.txsSummary[r][t][o].value+=n.credit,p.txsSummary[r][t][o].value-=n.debit)})})})}function d(){if("Cooking"==p.prodReport.lastStatus){var o=i(p.prodReport.cooking.startAt);const t=i();p.batch.secElapsed=i.duration(t.diff(o)).as("seconds"),function(){var o=i(p.prodReport.cooking.startAt);const t=i();o=100*(i.duration(t.diff(o)).as("seconds")/1200).toFixed(2),p.batch.prcntPrgs=o}()}}p.user=firebase.auth().currentUser,p.channel=r(firebase.database().ref("Channels/"+o.channelId)),p.engagment=r(firebase.database().ref("Engagments/"+o.engmntId)),p.recipes=function(t){const e={};return Object.keys(t).forEach(function(o){"recipe"==t[o].type&&(e[o]=t[o])}),e}(a.models.operations),p.cookingList=[],p.txsList=[],p.conditions={temperature:66,wind:{speed:0,deg:0},roaster:""},p.batch={prcntPrgs:0,secElapsed:0},p.roasters=["214606","213588","21353x","216693"],p.txsSummary={debits:{nuts:{pecans:{id:"-MmdFOUdWJKSaiY8qSBP",value:0},almonds:{id:"-Mnwy1lULD6uf9qPLb7w",value:0},cashews:{id:"-Mnwy9s4CdquFHL4EBpJ",value:0},hazelnuts:{id:"-MnwyPKyV9j1riq3z_Jv",value:0}},packaging:{pintcups:{id:"-Mo9ypVIJTf09YLBRGTd",value:0},pintLids:{id:"-Mo9yxhpuLbnJLqsjZfo",value:0},halfCups:{id:"-Mo9zUaMv11hJrJ4tref",value:0},halfLids:{id:"-Mo9zW4ShhozB04JDoh8",value:0},platTops:{id:"-Mo9zXdi2ZCUqPG6iTh-",value:0},platBots:{id:"-Mo9zYz8loLwGvu8fGB2",value:0}},cooking:{ssMix:{id:"-MjSoxKn1xrLk8L1b8PK",value:0},bbMix:{id:"-Mnv9B2Eip7PPZaN7aYa",value:0},salt:{id:"-MjSoxKn1xrLk8L1b8PK",value:0}},misc:{paperTowel:{id:"-Mo9zsxpeHi8estWW0bG",value:0},gasoline:{id:"-Mo9zo0gB2vNAwGThDbe",value:0}}},credits:{},balances:{"-MjSoxLGadkQpxtTuhCK":0,"-MnwvGpt6TTehfomFo18":0,"-MnwvK9M4P5v_9w_2cSa":22,"-MnwvNdZ2xqY2_8u9Ub7":0,"-MnvHa-65LfIp63akaI-":0,"-MnwvSTpy0dJAU5S_vgi":0,"-MnwvTh3Ax5g7KuZL8SB":0,"-MnwvXyu20U9VpKhWoJB":0,"-MjSoxKn1xrLk8L1b8PK":0,"-Mnv9B2Eip7PPZaN7aYa":0}},a.data.production.report.$bindTo(e,"vm.prodReport").then(function(){!function(){p.cookingList=[],null!=p.prodReport.journalEntries&&null!=p.prodReport.journalEntries||(p.prodReport.journalEntries={});Object.keys(p.prodReport.journalEntries).forEach(function(o){if("_hold"!=o){o="/JournalEntries/"+p.prodReport.journalEntries[o];const t=firebase.database();o=t.ref(o);p.cookingList.push(r(o))}})}(),function(){p.txsList=[],null!=p.prodReport.txs&&null!=p.prodReport.txs||(p.prodReport.txs={});Object.keys(p.prodReport.txs).forEach(function(o){if("_hold"!=o){o="Transactions/"+o;const t=firebase.database();o=t.ref(o),o=r(o).$loaded().then(function(o){c(o)});p.txsList.push(o)}})}()}),p.selectRecipe=function(o){console.log("vm.prodReport",p.prodReport);var t=null==p.prodReport.ondeck.recipe,e=p.prodReport.ondeck.recipe==p.recipes[o].recipe&&p.prodReport.ondeck.nut==p.recipes[o].nut;(!t||e)&&(t||e)?!t&&e&&(p.prodReport.ondeck={_hold:""}):p.prodReport.ondeck=p.recipes[o]},p.startNewBatch=function(){null!=p.prodReport.ondeck.recipe?(console.log("moving cooking to cooling",p.prodReport),p.prodReport.cooling=p.prodReport.cooking,p.prodReport.cooking=p.prodReport.ondeck,p.prodReport.lastStatus="Cooking",p.prodReport.cooking.startAt=i().format(),p.prodReport.cooking.expiresAt=i(p.prodReport.cooking.startAt).add(20,"minutes").format(),p.prodReport.memberId="L1kSg6D6EIZP2ctV7bI0kEkZRAm2",p.prodReport.temp=p.conditions.temperature,p.prodReport.roasterId=p.conditions.roaster,p.batch.secElapsed=0,a.production.journalBatchStart(p.prodReport).then(function(o){var t="JournalEntries/"+o.jeId;const e=firebase.database();t=e.ref(t),t=r(t);p.cookingList.push(t),p.prodReport.journalEntries[i().format()]=o.jeId,o.txIds.forEach(function(o){var t="Transactions/"+o;const e=firebase.database();t=e.ref(t),t=r(t).$loaded().then(function(o){c(o)});p.txsList.push(t),null!=p.prodReport.txs&&null!=p.prodReport.txs||(p.prodReport.txs={}),p.prodReport.txs[o]=o})}),p.prodReport.ondeck={_hold:""}):console.log("need to select a batch first")},p.calculateCookingDone=function(o){if(""==o)return"";{const t=i(o);return t.add(12,"minutes").format("h:mm a")+" - "+t.add(16,"minutes").format("h:mm a")}},p.calculateCookingError=function(o){},p.validatePercentProgress=function(o){return null==o||NaN==o?0:o},p.dateEnding=function(o){},console.log("in the miniship production controller "),t(function(){d()},1e3)}ckc.controller("minishopProductionController",minishopProductionController),minishopProductionController.$inject=["$firebaseObject","$routeParams","$interval","$scope","$window","msData","moment","$http"];
function minishopSalesTxsController(){console.log("in the miniship sales transactions controller ")}ckc.controller("minishopSalesTxsController",minishopSalesTxsController),minishopSalesTxsController.$inject=[];
function minishopStngsController(n){console.log("in the miniship settings controller ")}ckc.controller("minishopStngsController",minishopStngsController),minishopStngsController.$inject=["MiniShop"];